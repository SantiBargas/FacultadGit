close all; clear all; more off;

xnode = [
  0.0000000000000000, 0.0000000000000000;
  0.0000000000000000, 0.1666666666666667;
  0.0000000000000000, 0.3333333333333333;
  0.0000000000000000, 0.5000000000000000;
  0.3333333333333333, 0.0000000000000000;
  0.3333333333333333, 0.1666666666666667;
  0.3333333333333333, 0.3333333333333333;
  0.3333333333333333, 0.5000000000000000;
  0.6666666666666666, 0.0000000000000000;
  0.6666666666666666, 0.1666666666666667;
  0.6666666666666666, 0.3333333333333333;
  0.6666666666666666, 0.5000000000000000;
  1.0000000000000000, 0.0000000000000000;
  1.0000000000000000, 0.1666666666666667;
  1.0000000000000000, 0.3333333333333333;
  1.0000000000000000, 0.5000000000000000;
];

icone = [
       1,      5,      6,     -1;
       1,      6,      2,     -1;
       2,      6,      7,      3;
       3,      7,      4,     -1;
       5,      9,     10,      6;
       7,      8,      4,     -1;
       7,     11,     12,      8;
       9,     13,     10,     -1;
      10,     14,     15,     11;
      11,     15,     16,     -1;
      11,     16,     12,     -1;
      13,     14,     10,     -1;
];

Fixnodes = [
       1,      1, -0.1000000000000000;
       1,      1, 0.2500000000000000;
       1,      2, -0.1500000000000000;
       1,      2, 0.0000000000000000;
       2,      1, 0.2500000000000000;
       2,      2, 0.0000000000000000;
       3,      1, 0.2500000000000000;
       3,      2, 0.0000000000000000;
       4,      1, 0.2500000000000000;
       4,      2, 0.0000000000000000;
       5,      1, -0.1000000000000000;
       5,      2, -0.1500000000000000;
       9,      1, -0.1000000000000000;
       9,      2, -0.1500000000000000;
      10,      1, 0.0000000000000000;
      10,      2, -0.2000000000000000;
      11,      1, 0.0000000000000000;
      11,      2, -0.2000000000000000;
      13,      1, -0.1000000000000000;
      13,      2, -0.1500000000000000;
];

Sideload = [
       6,      7, 0.0000000000000000, -3.0000000000000000;
       7,     11, 10.0000000000000000, 0.0000000000000000;
       8,      4, -15.0000000000000000, 0.0000000000000000;
      10,      6, 7.0000000000000000, 5.0000000000000000;
      12,      8, -15.0000000000000000, 0.0000000000000000;
      13,     14, 5.0000000000000000, 13.0000000000000000;
      14,     15, 5.0000000000000000, 13.0000000000000000;
      15,     16, 5.0000000000000000, 13.0000000000000000;
      16,     12, -15.0000000000000000, 0.0000000000000000;
];

Pointload = [
       4, 0.4800000000000000, -0.6000000000000000, 0.2500000000000000, 0.3600000000000000
];

disp('---------------------------------------------------------------');
disp('Inicializando modelo de datos...');

model.nnodes = size(xnode,1);
model.nelem = size(icone,1);

model.young = 3000000.0000000000000000;
model.poiss = 72000.0000000000000000;
model.gravity = 9.8100000000000005;
model.pstrs = 1;
model.thick = 1.0000000000000000;

disp('Iniciando el método numérico...');

% Llamada principal al Método de Elementos Finitos
[U,reaction,Def,Ten,Ten_VM] = fem2d_pstr(xnode,icone,Fixnodes,Sideload,Pointload,model);

disp('Finalizada la ejecución del método numérico.');

disp('---------------------------------------------------------------');
disp('Iniciando el post-procesamiento...');

% mode ---> modo de visualización:
%           [0] 2D - Con malla
%           [1] 2D - Sin malla
% graph --> tipo de gráfica:
%           [0] Estado inicial vs. desplazamiento
%           [1] Von Misses (escalar)
%           [2] Reacciones (vectorial)
% scale --> factor de escala para U (en veces)
mode = 0;
graph = 0;
scale = 1;
U = scale * U;
fem2d_pstr_graph_mesh(U,reaction,Ten_VM,xnode,icone,mode,graph);

disp('Finalizado el post-procesamiento.');
